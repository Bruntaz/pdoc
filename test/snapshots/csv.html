<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style type="text/css">/*!
 * Bootstrap Reboot v5.0.0-beta1 (https://getbootstrap.com/)
 * Copyright 2011-2020 The Bootstrap Authors
 * Copyright 2011-2020 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE)
 * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md)
 */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}[tabindex="-1"]:focus:not(:focus-visible){outline:0!important}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus{outline:dotted 1px;outline:-webkit-focus-ring-color auto 5px}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style type="text/css">html, body {width: 100%;height: 100%;position: relative;}.container {display: flex;padding: 1rem;}nav {flex: 1;max-width: 300px;}main {flex: 1;}nav a {text-decoration: none;}.attr {margin: .2rem;background-color: rgba(0, 0, 0, 0.1);}.function .def {font-weight: 300;}.function .signature {font-weight: 300;}.annotation:not(:empty):before {content: ": ";color: #666666;}.int {color: #666;}.str {color: #BA2121;}nav .class:before {content: "class ";color: gray;}nav .function:after {content: "()";color: gray;}h1, h2, h3, h4, h5 {font-weight: 300;}footer {font-size: 20px;text-align: right;padding: 1rem;}footer svg {max-width: 70px;transition: all 200ms;filter: grayscale(100%);}footer svg:hover {filter: grayscale(0%);}section {margin: 1rem;border: solid gray 1px;}</style><style type="text/css">pre { line-height: 125%; }td.linenos pre { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }span.linenos { color: #000000; background-color: #f0f0f0; padding-left: 5px; padding-right: 5px; }td.linenos pre.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }.codehilite .hll { background-color: #ffffcc }.codehilite .c { color: #408080; font-style: italic } /* Comment */.codehilite .err { border: 1px solid #FF0000 } /* Error */.codehilite .k { color: #008000; font-weight: bold } /* Keyword */.codehilite .o { color: #666666 } /* Operator */.codehilite .ch { color: #408080; font-style: italic } /* Comment.Hashbang */.codehilite .cm { color: #408080; font-style: italic } /* Comment.Multiline */.codehilite .cp { color: #BC7A00 } /* Comment.Preproc */.codehilite .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */.codehilite .c1 { color: #408080; font-style: italic } /* Comment.Single */.codehilite .cs { color: #408080; font-style: italic } /* Comment.Special */.codehilite .gd { color: #A00000 } /* Generic.Deleted */.codehilite .ge { font-style: italic } /* Generic.Emph */.codehilite .gr { color: #FF0000 } /* Generic.Error */.codehilite .gh { color: #000080; font-weight: bold } /* Generic.Heading */.codehilite .gi { color: #00A000 } /* Generic.Inserted */.codehilite .go { color: #888888 } /* Generic.Output */.codehilite .gp { color: #000080; font-weight: bold } /* Generic.Prompt */.codehilite .gs { font-weight: bold } /* Generic.Strong */.codehilite .gu { color: #800080; font-weight: bold } /* Generic.Subheading */.codehilite .gt { color: #0044DD } /* Generic.Traceback */.codehilite .kc { color: #008000; font-weight: bold } /* Keyword.Constant */.codehilite .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */.codehilite .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */.codehilite .kp { color: #008000 } /* Keyword.Pseudo */.codehilite .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */.codehilite .kt { color: #B00040 } /* Keyword.Type */.codehilite .m { color: #666666 } /* Literal.Number */.codehilite .s { color: #BA2121 } /* Literal.String */.codehilite .na { color: #7D9029 } /* Name.Attribute */.codehilite .nb { color: #008000 } /* Name.Builtin */.codehilite .nc { color: #0000FF; font-weight: bold } /* Name.Class */.codehilite .no { color: #880000 } /* Name.Constant */.codehilite .nd { color: #AA22FF } /* Name.Decorator */.codehilite .ni { color: #999999; font-weight: bold } /* Name.Entity */.codehilite .ne { color: #D2413A; font-weight: bold } /* Name.Exception */.codehilite .nf { color: #0000FF } /* Name.Function */.codehilite .nl { color: #A0A000 } /* Name.Label */.codehilite .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */.codehilite .nt { color: #008000; font-weight: bold } /* Name.Tag */.codehilite .nv { color: #19177C } /* Name.Variable */.codehilite .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */.codehilite .w { color: #bbbbbb } /* Text.Whitespace */.codehilite .mb { color: #666666 } /* Literal.Number.Bin */.codehilite .mf { color: #666666 } /* Literal.Number.Float */.codehilite .mh { color: #666666 } /* Literal.Number.Hex */.codehilite .mi { color: #666666 } /* Literal.Number.Integer */.codehilite .mo { color: #666666 } /* Literal.Number.Oct */.codehilite .sa { color: #BA2121 } /* Literal.String.Affix */.codehilite .sb { color: #BA2121 } /* Literal.String.Backtick */.codehilite .sc { color: #BA2121 } /* Literal.String.Char */.codehilite .dl { color: #BA2121 } /* Literal.String.Delimiter */.codehilite .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */.codehilite .s2 { color: #BA2121 } /* Literal.String.Double */.codehilite .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */.codehilite .sh { color: #BA2121 } /* Literal.String.Heredoc */.codehilite .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */.codehilite .sx { color: #008000 } /* Literal.String.Other */.codehilite .sr { color: #BB6688 } /* Literal.String.Regex */.codehilite .s1 { color: #BA2121 } /* Literal.String.Single */.codehilite .ss { color: #19177C } /* Literal.String.Symbol */.codehilite .bp { color: #008000 } /* Name.Builtin.Pseudo */.codehilite .fm { color: #0000FF } /* Name.Function.Magic */.codehilite .vc { color: #19177C } /* Name.Variable.Class */.codehilite .vg { color: #19177C } /* Name.Variable.Global */.codehilite .vi { color: #19177C } /* Name.Variable.Instance */.codehilite .vm { color: #19177C } /* Name.Variable.Magic */.codehilite .il { color: #666666 } /* Literal.Number.Integer.Long */</style><style type="text/css"></style>

    <title>csv</title>
</head>
<body>










    <div class="container">
        <nav>
            <h1>Index</h1>
            

            
                <h2>Contents</h2>
                
        <ul>
            
                <li>
                    
                        <a class="variable" href="#QUOTE_MINIMAL">QUOTE_MINIMAL</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#QUOTE_ALL">QUOTE_ALL</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#QUOTE_NONNUMERIC">QUOTE_NONNUMERIC</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#QUOTE_NONE">QUOTE_NONE</a>
                    
                </li>
            
                <li>
                    
                        <a class="class" href="#Error">Error</a>
                        
        <ul>
            
                <li>
                    
                        <a class="function" href="#Error.__init__">__init__</a>
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#Error.with_traceback">with_traceback</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#Error.args">args</a>
                    
                </li>
            
        </ul>
    
                    
                </li>
            
                <li>
                    
                        <a class="class" href="#Dialect">Dialect</a>
                        
        <ul>
            
                <li>
                    
                        <a class="function" href="#Dialect.__init__">__init__</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#Dialect.delimiter">delimiter</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#Dialect.quotechar">quotechar</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#Dialect.escapechar">escapechar</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#Dialect.doublequote">doublequote</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#Dialect.skipinitialspace">skipinitialspace</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#Dialect.lineterminator">lineterminator</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#Dialect.quoting">quoting</a>
                    
                </li>
            
        </ul>
    
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#__doc__">__doc__</a>
                    
                </li>
            
                <li>
                    
                        <a class="class" href="#excel">excel</a>
                        
        <ul>
            
                <li>
                    
                        <a class="function" href="#excel.__init__">__init__</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel.delimiter">delimiter</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel.quotechar">quotechar</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel.doublequote">doublequote</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel.skipinitialspace">skipinitialspace</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel.lineterminator">lineterminator</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel.quoting">quoting</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel.escapechar">escapechar</a>
                    
                </li>
            
        </ul>
    
                    
                </li>
            
                <li>
                    
                        <a class="class" href="#excel_tab">excel_tab</a>
                        
        <ul>
            
                <li>
                    
                        <a class="function" href="#excel_tab.__init__">__init__</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel_tab.delimiter">delimiter</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel_tab.quotechar">quotechar</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel_tab.doublequote">doublequote</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel_tab.skipinitialspace">skipinitialspace</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel_tab.lineterminator">lineterminator</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel_tab.quoting">quoting</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#excel_tab.escapechar">escapechar</a>
                    
                </li>
            
        </ul>
    
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#field_size_limit">field_size_limit</a>
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#reader">reader</a>
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#writer">writer</a>
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#register_dialect">register_dialect</a>
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#get_dialect">get_dialect</a>
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#list_dialects">list_dialects</a>
                    
                </li>
            
                <li>
                    
                        <a class="class" href="#Sniffer">Sniffer</a>
                        
        <ul>
            
                <li>
                    
                        <a class="function" href="#Sniffer.__init__">__init__</a>
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#Sniffer.sniff">sniff</a>
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#Sniffer.has_header">has_header</a>
                    
                </li>
            
        </ul>
    
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#unregister_dialect">unregister_dialect</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#__version__">__version__</a>
                    
                </li>
            
                <li>
                    
                        <a class="class" href="#DictReader">DictReader</a>
                        
        <ul>
            
                <li>
                    
                        <a class="function" href="#DictReader.__init__">__init__</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#DictReader.fieldnames">fieldnames</a>
                    
                </li>
            
        </ul>
    
                    
                </li>
            
                <li>
                    
                        <a class="class" href="#DictWriter">DictWriter</a>
                        
        <ul>
            
                <li>
                    
                        <a class="function" href="#DictWriter.__init__">__init__</a>
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#DictWriter.writeheader">writeheader</a>
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#DictWriter.writerow">writerow</a>
                    
                </li>
            
                <li>
                    
                        <a class="function" href="#DictWriter.writerows">writerows</a>
                    
                </li>
            
        </ul>
    
                    
                </li>
            
                <li>
                    
                        <a class="class" href="#unix_dialect">unix_dialect</a>
                        
        <ul>
            
                <li>
                    
                        <a class="function" href="#unix_dialect.__init__">__init__</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#unix_dialect.delimiter">delimiter</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#unix_dialect.quotechar">quotechar</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#unix_dialect.doublequote">doublequote</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#unix_dialect.skipinitialspace">skipinitialspace</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#unix_dialect.lineterminator">lineterminator</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#unix_dialect.quoting">quoting</a>
                    
                </li>
            
                <li>
                    
                        <a class="variable" href="#unix_dialect.escapechar">escapechar</a>
                    
                </li>
            
        </ul>
    
                    
                </li>
            
        </ul>
    
            
        </nav>
        <main>
            <h1>csv module</h1>
            <p>CSV parsing and writing.</p>

<p>This module provides classes that assist in the reading and writing
of Comma Separated Value (CSV) files, and implements the interface
described by PEP 305.  Although many CSV files are simple to parse,
the format is not formally defined by a stable specification and
is subtle enough that parsing lines of a CSV file with something
like line.split(",") is bound to fail.  The module supports three
basic APIs: reading, writing, and registration of dialects.</p>

<p>DIALECT REGISTRATION:</p>

<p>Readers and writers support a dialect argument, which is a convenient
handle on a group of settings.  When the dialect argument is a string,
it identifies one of the dialects previously registered with the module.
If it is a class or instance, the attributes of the argument are used as
the settings for the reader or writer:</p>

<pre><code>class excel:
    delimiter = ','
    quotechar = '"'
    escapechar = None
    doublequote = True
    skipinitialspace = False
    lineterminator = '\r\n'
    quoting = QUOTE_MINIMAL
</code></pre>

<p>SETTINGS:</p>

<pre><code>* quotechar - specifies a one-character string to use as the
    quoting character.  It defaults to '"'.
* delimiter - specifies a one-character string to use as the
    field separator.  It defaults to ','.
* skipinitialspace - specifies how to interpret whitespace which
    immediately follows a delimiter.  It defaults to False, which
    means that whitespace immediately following a delimiter is part
    of the following field.
* lineterminator -  specifies the character sequence which should
    terminate rows.
* quoting - controls when quotes should be generated by the writer.
    It can take on any of the following module constants:

    csv.QUOTE_MINIMAL means only when required, for example, when a
        field contains either the quotechar or the delimiter
    csv.QUOTE_ALL means that quotes are always placed around fields.
    csv.QUOTE_NONNUMERIC means that quotes are always placed around
        fields which do not parse as integers or floating point
        numbers.
    csv.QUOTE_NONE means that quotes are never placed around fields.
* escapechar - specifies a one-character string used to escape
    the delimiter when quoting is set to QUOTE_NONE.
* doublequote - controls the handling of quotes inside fields.  When
    True, two consecutive quotes are interpreted as one during read,
    and when writing, each quote character embedded in the data is
    written as two quotes
</code></pre>

            <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">csv.py - read/write/investigate CSV files</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">from</span> <span class="nn">_csv</span> <span class="kn">import</span> <span class="n">Error</span><span class="p">,</span> <span class="n">__version__</span><span class="p">,</span> <span class="n">writer</span><span class="p">,</span> <span class="n">reader</span><span class="p">,</span> <span class="n">register_dialect</span><span class="p">,</span> \
                 <span class="n">unregister_dialect</span><span class="p">,</span> <span class="n">get_dialect</span><span class="p">,</span> <span class="n">list_dialects</span><span class="p">,</span> \
                 <span class="n">field_size_limit</span><span class="p">,</span> \
                 <span class="n">QUOTE_MINIMAL</span><span class="p">,</span> <span class="n">QUOTE_ALL</span><span class="p">,</span> <span class="n">QUOTE_NONNUMERIC</span><span class="p">,</span> <span class="n">QUOTE_NONE</span><span class="p">,</span> \
                 <span class="vm">__doc__</span>
<span class="kn">from</span> <span class="nn">_csv</span> <span class="kn">import</span> <span class="n">Dialect</span> <span class="k">as</span> <span class="n">_Dialect</span>

<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">StringIO</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;QUOTE_MINIMAL&quot;</span><span class="p">,</span> <span class="s2">&quot;QUOTE_ALL&quot;</span><span class="p">,</span> <span class="s2">&quot;QUOTE_NONNUMERIC&quot;</span><span class="p">,</span> <span class="s2">&quot;QUOTE_NONE&quot;</span><span class="p">,</span>
           <span class="s2">&quot;Error&quot;</span><span class="p">,</span> <span class="s2">&quot;Dialect&quot;</span><span class="p">,</span> <span class="s2">&quot;__doc__&quot;</span><span class="p">,</span> <span class="s2">&quot;excel&quot;</span><span class="p">,</span> <span class="s2">&quot;excel_tab&quot;</span><span class="p">,</span>
           <span class="s2">&quot;field_size_limit&quot;</span><span class="p">,</span> <span class="s2">&quot;reader&quot;</span><span class="p">,</span> <span class="s2">&quot;writer&quot;</span><span class="p">,</span>
           <span class="s2">&quot;register_dialect&quot;</span><span class="p">,</span> <span class="s2">&quot;get_dialect&quot;</span><span class="p">,</span> <span class="s2">&quot;list_dialects&quot;</span><span class="p">,</span> <span class="s2">&quot;Sniffer&quot;</span><span class="p">,</span>
           <span class="s2">&quot;unregister_dialect&quot;</span><span class="p">,</span> <span class="s2">&quot;__version__&quot;</span><span class="p">,</span> <span class="s2">&quot;DictReader&quot;</span><span class="p">,</span> <span class="s2">&quot;DictWriter&quot;</span><span class="p">,</span>
           <span class="s2">&quot;unix_dialect&quot;</span><span class="p">]</span>

<span class="k">class</span> <span class="nc">Dialect</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Describe a CSV dialect.</span>

<span class="sd">    This must be subclassed (see csv.excel).  Valid attributes are:</span>
<span class="sd">    delimiter, quotechar, escapechar, doublequote, skipinitialspace,</span>
<span class="sd">    lineterminator, quoting.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># placeholders</span>
    <span class="n">delimiter</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">quotechar</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">escapechar</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">doublequote</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">lineterminator</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">quoting</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">!=</span> <span class="n">Dialect</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_Dialect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># We do this for compatibility with py2.3</span>
            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>

<span class="k">class</span> <span class="nc">excel</span><span class="p">(</span><span class="n">Dialect</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Describe the usual properties of Excel-generated CSV files.&quot;&quot;&quot;</span>
    <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span>
    <span class="n">quotechar</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span>
    <span class="n">doublequote</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">lineterminator</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
    <span class="n">quoting</span> <span class="o">=</span> <span class="n">QUOTE_MINIMAL</span>
<span class="n">register_dialect</span><span class="p">(</span><span class="s2">&quot;excel&quot;</span><span class="p">,</span> <span class="n">excel</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">excel_tab</span><span class="p">(</span><span class="n">excel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Describe the usual properties of Excel-generated TAB-delimited files.&quot;&quot;&quot;</span>
    <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span>
<span class="n">register_dialect</span><span class="p">(</span><span class="s2">&quot;excel-tab&quot;</span><span class="p">,</span> <span class="n">excel_tab</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">unix_dialect</span><span class="p">(</span><span class="n">Dialect</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Describe the usual properties of Unix-generated CSV files.&quot;&quot;&quot;</span>
    <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span>
    <span class="n">quotechar</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span>
    <span class="n">doublequote</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">lineterminator</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">quoting</span> <span class="o">=</span> <span class="n">QUOTE_ALL</span>
<span class="n">register_dialect</span><span class="p">(</span><span class="s2">&quot;unix&quot;</span><span class="p">,</span> <span class="n">unix_dialect</span><span class="p">)</span>


<span class="k">class</span> <span class="nc">DictReader</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">fieldnames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restkey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">dialect</span><span class="o">=</span><span class="s2">&quot;excel&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fieldnames</span> <span class="o">=</span> <span class="n">fieldnames</span>   <span class="c1"># list of keys for the dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restkey</span> <span class="o">=</span> <span class="n">restkey</span>          <span class="c1"># key to catch long rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restval</span> <span class="o">=</span> <span class="n">restval</span>          <span class="c1"># default value for short rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialect</span> <span class="o">=</span> <span class="n">dialect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_num</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fieldnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fieldnames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_fieldnames</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">line_num</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fieldnames</span>

    <span class="nd">@fieldnames</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">fieldnames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fieldnames</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Used only for its side effect.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span>
        <span class="n">row</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">line_num</span>

        <span class="c1"># unlike the basic reader, we prefer not to return blanks,</span>
        <span class="c1"># because we will typically wind up with a dict full of None</span>
        <span class="c1"># values</span>
        <span class="k">while</span> <span class="n">row</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">,</span> <span class="n">row</span><span class="p">))</span>
        <span class="n">lf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">)</span>
        <span class="n">lr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lf</span> <span class="o">&lt;</span> <span class="n">lr</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">restkey</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">lf</span><span class="p">:]</span>
        <span class="k">elif</span> <span class="n">lf</span> <span class="o">&gt;</span> <span class="n">lr</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">[</span><span class="n">lr</span><span class="p">:]:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">restval</span>
        <span class="k">return</span> <span class="n">d</span>


<span class="k">class</span> <span class="nc">DictWriter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">fieldnames</span><span class="p">,</span> <span class="n">restval</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">extrasaction</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span>
                 <span class="n">dialect</span><span class="o">=</span><span class="s2">&quot;excel&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span> <span class="o">=</span> <span class="n">fieldnames</span>    <span class="c1"># list of keys for the dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restval</span> <span class="o">=</span> <span class="n">restval</span>          <span class="c1"># for writing short dicts</span>
        <span class="k">if</span> <span class="n">extrasaction</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;extrasaction (</span><span class="si">%s</span><span class="s2">) must be &#39;raise&#39; or &#39;ignore&#39;&quot;</span>
                             <span class="o">%</span> <span class="n">extrasaction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extrasaction</span> <span class="o">=</span> <span class="n">extrasaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">writeheader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">header</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_dict_to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rowdict</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrasaction</span> <span class="o">==</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
            <span class="n">wrong_fields</span> <span class="o">=</span> <span class="n">rowdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span>
            <span class="k">if</span> <span class="n">wrong_fields</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dict contains fields not in fieldnames: &quot;</span>
                                 <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">repr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wrong_fields</span><span class="p">]))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">rowdict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">restval</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">writerow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rowdict</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dict_to_list</span><span class="p">(</span><span class="n">rowdict</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">writerows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rowdicts</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dict_to_list</span><span class="p">,</span> <span class="n">rowdicts</span><span class="p">))</span>

<span class="c1"># Guard Sniffer&#39;s type checking against builds that exclude complex()</span>
<span class="k">try</span><span class="p">:</span>
    <span class="nb">complex</span>
<span class="k">except</span> <span class="ne">NameError</span><span class="p">:</span>
    <span class="nb">complex</span> <span class="o">=</span> <span class="nb">float</span>

<span class="k">class</span> <span class="nc">Sniffer</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    &quot;Sniffs&quot; the format of a CSV file (i.e. delimiter, quotechar)</span>
<span class="sd">    Returns a Dialect object.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># in case there is more than one possible delimiter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferred</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">sniff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">delimiters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dialect (or None) corresponding to the sample</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">quotechar</span><span class="p">,</span> <span class="n">doublequote</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">,</span> <span class="n">skipinitialspace</span> <span class="o">=</span> \
                   <span class="bp">self</span><span class="o">.</span><span class="n">_guess_quote_and_delimiter</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">delimiters</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">delimiter</span><span class="p">:</span>
            <span class="n">delimiter</span><span class="p">,</span> <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_guess_delimiter</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span>
                                                                <span class="n">delimiters</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">delimiter</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s2">&quot;Could not determine delimiter&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">dialect</span><span class="p">(</span><span class="n">Dialect</span><span class="p">):</span>
            <span class="n">_name</span> <span class="o">=</span> <span class="s2">&quot;sniffed&quot;</span>
            <span class="n">lineterminator</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
            <span class="n">quoting</span> <span class="o">=</span> <span class="n">QUOTE_MINIMAL</span>
            <span class="c1"># escapechar = &#39;&#39;</span>

        <span class="n">dialect</span><span class="o">.</span><span class="n">doublequote</span> <span class="o">=</span> <span class="n">doublequote</span>
        <span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">delimiter</span>
        <span class="c1"># _csv.reader won&#39;t accept a quotechar of &#39;&#39;</span>
        <span class="n">dialect</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">quotechar</span> <span class="ow">or</span> <span class="s1">&#39;&quot;&#39;</span>
        <span class="n">dialect</span><span class="o">.</span><span class="n">skipinitialspace</span> <span class="o">=</span> <span class="n">skipinitialspace</span>

        <span class="k">return</span> <span class="n">dialect</span>


    <span class="k">def</span> <span class="nf">_guess_quote_and_delimiter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">delimiters</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Looks for text enclosed between two identical quotes</span>
<span class="sd">        (the probable quotechar) which are preceded and followed</span>
<span class="sd">        by the same character (the probable delimiter).</span>
<span class="sd">        For example:</span>
<span class="sd">                         ,&#39;some text&#39;,</span>
<span class="sd">        The quote with the most wins, same with the delimiter.</span>
<span class="sd">        If there is no quotechar the delimiter can&#39;t be determined</span>
<span class="sd">        this way.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">restr</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?P&lt;delim&gt;[^\w\n&quot;</span><span class="se">\&#39;</span><span class="s1">])(?P&lt;space&gt; ?)(?P&lt;quote&gt;[&quot;</span><span class="se">\&#39;</span><span class="s1">]).*?(?P=quote)(?P=delim)&#39;</span><span class="p">,</span> <span class="c1"># ,&quot;.*?&quot;,</span>
                      <span class="sa">r</span><span class="s1">&#39;(?:^|\n)(?P&lt;quote&gt;[&quot;</span><span class="se">\&#39;</span><span class="s1">]).*?(?P=quote)(?P&lt;delim&gt;[^\w\n&quot;</span><span class="se">\&#39;</span><span class="s1">])(?P&lt;space&gt; ?)&#39;</span><span class="p">,</span>   <span class="c1">#  &quot;.*?&quot;,</span>
                      <span class="sa">r</span><span class="s1">&#39;(?P&lt;delim&gt;[^\w\n&quot;</span><span class="se">\&#39;</span><span class="s1">])(?P&lt;space&gt; ?)(?P&lt;quote&gt;[&quot;</span><span class="se">\&#39;</span><span class="s1">]).*?(?P=quote)(?:$|\n)&#39;</span><span class="p">,</span>   <span class="c1"># ,&quot;.*?&quot;</span>
                      <span class="sa">r</span><span class="s1">&#39;(?:^|\n)(?P&lt;quote&gt;[&quot;</span><span class="se">\&#39;</span><span class="s1">]).*?(?P=quote)(?:$|\n)&#39;</span><span class="p">):</span>                            <span class="c1">#  &quot;.*?&quot; (no delim, no space)</span>
            <span class="n">regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">restr</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="n">regexp</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">matches</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">matches</span><span class="p">:</span>
            <span class="c1"># (quotechar, doublequote, delimiter, skipinitialspace)</span>
            <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">quotes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">delims</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">spaces</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">groupindex</span> <span class="o">=</span> <span class="n">regexp</span><span class="o">.</span><span class="n">groupindex</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">groupindex</span><span class="p">[</span><span class="s1">&#39;quote&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">quotes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">quotes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">groupindex</span><span class="p">[</span><span class="s1">&#39;delim&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">and</span> <span class="p">(</span><span class="n">delimiters</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">delimiters</span><span class="p">):</span>
                <span class="n">delims</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">delims</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">groupindex</span><span class="p">[</span><span class="s1">&#39;space&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
                <span class="n">spaces</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">quotechar</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">quotes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">quotes</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">delims</span><span class="p">:</span>
            <span class="n">delim</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">delims</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
            <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="n">delims</span><span class="p">[</span><span class="n">delim</span><span class="p">]</span> <span class="o">==</span> <span class="n">spaces</span>
            <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span> <span class="c1"># most likely a file with a single column</span>
                <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># there is *no* delimiter, it&#39;s a single column of quoted data</span>
            <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># if we see an extra quote between delimiters, we&#39;ve got a</span>
        <span class="c1"># double quoted format</span>
        <span class="n">dq_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
                               <span class="sa">r</span><span class="s2">&quot;((</span><span class="si">%(delim)s</span><span class="s2">)|^)\W*</span><span class="si">%(quote)s</span><span class="s2">[^</span><span class="si">%(delim)s</span><span class="s2">\n]*</span><span class="si">%(quote)s</span><span class="s2">[^</span><span class="si">%(delim)s</span><span class="s2">\n]*</span><span class="si">%(quote)s</span><span class="s2">\W*((</span><span class="si">%(delim)s</span><span class="s2">)|$)&quot;</span> <span class="o">%</span> \
                               <span class="p">{</span><span class="s1">&#39;delim&#39;</span><span class="p">:</span><span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="s1">&#39;quote&#39;</span><span class="p">:</span><span class="n">quotechar</span><span class="p">},</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>



        <span class="k">if</span> <span class="n">dq_regexp</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="n">doublequote</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">doublequote</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">quotechar</span><span class="p">,</span> <span class="n">doublequote</span><span class="p">,</span> <span class="n">delim</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_guess_delimiter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">delimiters</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The delimiter /should/ occur the same number of times on</span>
<span class="sd">        each row. However, due to malformed data, it may not. We don&#39;t want</span>
<span class="sd">        an all or nothing approach, so we allow for small variations in this</span>
<span class="sd">        number.</span>
<span class="sd">          1) build a table of the frequency of each character on every line.</span>
<span class="sd">          2) build a table of frequencies of this frequency (meta-frequency?),</span>
<span class="sd">             e.g.  &#39;x occurred 5 times in 10 rows, 6 times in 1000 rows,</span>
<span class="sd">             7 times in 2 rows&#39;</span>
<span class="sd">          3) use the mode of the meta-frequency to determine the /expected/</span>
<span class="sd">             frequency for that character</span>
<span class="sd">          4) find out how often the character actually meets that goal</span>
<span class="sd">          5) the character that best meets its goal is the delimiter</span>
<span class="sd">        For performance reasons, the data is evaluated in chunks, so it can</span>
<span class="sd">        try and evaluate the smallest portion of the data possible, evaluating</span>
<span class="sd">        additional chunks as necessary.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)))</span>

        <span class="n">ascii</span> <span class="o">=</span> <span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">127</span><span class="p">)]</span> <span class="c1"># 7-bit ASCII</span>

        <span class="c1"># build frequency tables</span>
        <span class="n">chunkLength</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">charFrequency</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">modes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">delims</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">chunkLength</span>
        <span class="k">while</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">ascii</span><span class="p">:</span>
                    <span class="n">metaFrequency</span> <span class="o">=</span> <span class="n">charFrequency</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="c1"># must count even if frequency is 0</span>
                    <span class="n">freq</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                    <span class="c1"># value is the mode</span>
                    <span class="n">metaFrequency</span><span class="p">[</span><span class="n">freq</span><span class="p">]</span> <span class="o">=</span> <span class="n">metaFrequency</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">charFrequency</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="n">metaFrequency</span>

            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">charFrequency</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">charFrequency</span><span class="p">[</span><span class="n">char</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># get the mode of the frequencies</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">modes</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="c1"># adjust the mode - subtract the sum of all</span>
                    <span class="c1"># other frequencies</span>
                    <span class="n">items</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">modes</span><span class="p">[</span><span class="n">char</span><span class="p">])</span>
                    <span class="n">modes</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">modes</span><span class="p">[</span><span class="n">char</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">modes</span><span class="p">[</span><span class="n">char</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                                   <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">modes</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># build a list of possible delimiters</span>
            <span class="n">modeList</span> <span class="o">=</span> <span class="n">modes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="n">total</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">chunkLength</span> <span class="o">*</span> <span class="n">iteration</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
            <span class="c1"># (rows of consistent data) / (number of rows) = 100%</span>
            <span class="n">consistency</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="c1"># minimum consistency threshold</span>
            <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.9</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">delims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">consistency</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">modeList</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">((</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">total</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">consistency</span> <span class="ow">and</span>
                            <span class="p">(</span><span class="n">delimiters</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">delimiters</span><span class="p">)):</span>
                            <span class="n">delims</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
                <span class="n">consistency</span> <span class="o">-=</span> <span class="mf">0.01</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">delims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">delim</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">delims</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">delim</span><span class="p">)</span> <span class="o">==</span>
                                    <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%c</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">delim</span><span class="p">))</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">delim</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="p">)</span>

            <span class="c1"># analyze another chunkLength lines</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">end</span>
            <span class="n">end</span> <span class="o">+=</span> <span class="n">chunkLength</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">delims</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># if there&#39;s more than one, fall back to a &#39;preferred&#39; list</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">delims</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferred</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">delims</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">==</span>
                                        <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%c</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">d</span><span class="p">))</span>
                    <span class="k">return</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="p">)</span>

        <span class="c1"># nothing else indicates a preference, pick the character that</span>
        <span class="c1"># dominates(?)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[(</span><span class="n">v</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">delims</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">items</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">delim</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">delim</span><span class="p">)</span> <span class="o">==</span>
                            <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%c</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">delim</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">delim</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">has_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">):</span>
        <span class="c1"># Creates a dictionary of types of data in each column. If any</span>
        <span class="c1"># column is of a single type (say, integers), *except* for the first</span>
        <span class="c1"># row, then the first row is presumed to be labels. If the type</span>
        <span class="c1"># can&#39;t be determined, it is assumed to be a string in which case</span>
        <span class="c1"># the length of the string is the determining factor: if all of the</span>
        <span class="c1"># rows except for the first are the same length, it&#39;s a header.</span>
        <span class="c1"># Finally, a &#39;vote&#39; is taken at the end for each column, adding or</span>
        <span class="c1"># subtracting from the likelihood of the first row being a header.</span>

        <span class="n">rdr</span> <span class="o">=</span> <span class="n">reader</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">sample</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>

        <span class="n">header</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">rdr</span><span class="p">)</span> <span class="c1"># assume first row is header</span>

        <span class="n">columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="n">columnTypes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span> <span class="n">columnTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">checked</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rdr</span><span class="p">:</span>
            <span class="c1"># arbitrary number of rows to check, to keep it sane</span>
            <span class="k">if</span> <span class="n">checked</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">checked</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">!=</span> <span class="n">columns</span><span class="p">:</span>
                <span class="k">continue</span> <span class="c1"># skip rows that have irregular number of columns</span>

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">columnTypes</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>

                <span class="k">for</span> <span class="n">thisType</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">thisType</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
                        <span class="k">break</span>
                    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">OverflowError</span><span class="p">):</span>
                        <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># fallback to length of string</span>
                    <span class="n">thisType</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">thisType</span> <span class="o">!=</span> <span class="n">columnTypes</span><span class="p">[</span><span class="n">col</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">columnTypes</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># add new column type</span>
                        <span class="n">columnTypes</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisType</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># type is inconsistent, remove column from</span>
                        <span class="c1"># consideration</span>
                        <span class="k">del</span> <span class="n">columnTypes</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="c1"># finally, compare results against first row and &quot;vote&quot;</span>
        <span class="c1"># on whether it&#39;s a header</span>
        <span class="n">hasHeader</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">colType</span> <span class="ow">in</span> <span class="n">columnTypes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">colType</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="c1"># it&#39;s a length</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="n">col</span><span class="p">])</span> <span class="o">!=</span> <span class="n">colType</span><span class="p">:</span>
                    <span class="n">hasHeader</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hasHeader</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># attempt typecast</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">colType</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                    <span class="n">hasHeader</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hasHeader</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">hasHeader</span> <span class="o">&gt;</span> <span class="mi">0</span>
</pre></div>

    </details>
            
                <section id="QUOTE_MINIMAL">
                    
                        <div class="attr variable">QUOTE_MINIMAL<span
            class="annotation"></span><span class="default_value">
        
        = <span class="int">
        0</span>
    
    </span></div>
                    
                    <div class="docstring"><p></p>
</div>
                    
                    
                </section>
            
                <section id="QUOTE_ALL">
                    
                        <div class="attr variable">QUOTE_ALL<span
            class="annotation"></span><span class="default_value">
        
        = <span class="int">
        1</span>
    
    </span></div>
                    
                    <div class="docstring"><p></p>
</div>
                    
                    
                </section>
            
                <section id="QUOTE_NONNUMERIC">
                    
                        <div class="attr variable">QUOTE_NONNUMERIC<span
            class="annotation"></span><span class="default_value">
        
        = <span class="int">
        2</span>
    
    </span></div>
                    
                    <div class="docstring"><p></p>
</div>
                    
                    
                </section>
            
                <section id="QUOTE_NONE">
                    
                        <div class="attr variable">QUOTE_NONE<span
            class="annotation"></span><span class="default_value">
        
        = <span class="int">
        3</span>
    
    </span></div>
                    
                    <div class="docstring"><p></p>
</div>
                    
                    
                </section>
            
                <section id="Error">
                    
                        <div class="attr class">class Error(builtins.Exception):</div>
                    
                    <div class="docstring"><p>Common base class for all non-exit exceptions.</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span>
</pre></div>

    </details>
                    
                    
                        
                            <div id="Error.__init__" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Error.__init__&#39;)!
                                
                                    
        <div class="attr function">Error(self, /, *args, **kwargs)</div>
    

                                
                                
                            </div>
                        
                            <div id="Error.with_traceback" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Error.with_traceback&#39;)!
                                
                                    
        <div class="attr function"><span class="def">def</span> <span
                class="name">with_traceback</span><span class="signature">(unknown):</span></div>
    

                                
                                Exception.with_traceback(tb) --
set self.__traceback__ to tb and return self.
                            </div>
                        
                    
                </section>
            
                <section id="Dialect">
                    
                        <div class="attr class">class Dialect:</div>
                    
                    <div class="docstring"><p>Describe a CSV dialect.</p>

<p>This must be subclassed (see csv.excel).  Valid attributes are:
delimiter, quotechar, escapechar, doublequote, skipinitialspace,
lineterminator, quoting.</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Dialect</span><span class="p">:</span>
    <span class="sd">&quot;&quot;&quot;Describe a CSV dialect.</span>

<span class="sd">    This must be subclassed (see csv.excel).  Valid attributes are:</span>
<span class="sd">    delimiter, quotechar, escapechar, doublequote, skipinitialspace,</span>
<span class="sd">    lineterminator, quoting.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">_name</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
    <span class="n">_valid</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="c1"># placeholders</span>
    <span class="n">delimiter</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">quotechar</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">escapechar</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">doublequote</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">lineterminator</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">quoting</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="vm">__class__</span> <span class="o">!=</span> <span class="n">Dialect</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_valid</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_validate</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_validate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">_Dialect</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">TypeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="c1"># We do this for compatibility with py2.3</span>
            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
</pre></div>

    </details>
                    
                    
                        
                            <div id="Dialect.__init__" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Dialect.__init__&#39;)!
                                
                                    
        <div class="attr function">Dialect(self)</div>
    

                                
                                
                            </div>
                        
                            <div id="Dialect.delimiter" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Dialect.delimiter&#39;)!
                                
                                    <div class="attr variable">delimiter<span
            class="annotation"></span><span class="default_value">
        
        = <span class="NoneType">
        None</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="Dialect.quotechar" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Dialect.quotechar&#39;)!
                                
                                    <div class="attr variable">quotechar<span
            class="annotation"></span><span class="default_value">
        
        = <span class="NoneType">
        None</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="Dialect.escapechar" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Dialect.escapechar&#39;)!
                                
                                    <div class="attr variable">escapechar<span
            class="annotation"></span><span class="default_value">
        
        = <span class="NoneType">
        None</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="Dialect.doublequote" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Dialect.doublequote&#39;)!
                                
                                    <div class="attr variable">doublequote<span
            class="annotation"></span><span class="default_value">
        
        = <span class="NoneType">
        None</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="Dialect.skipinitialspace" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Dialect.skipinitialspace&#39;)!
                                
                                    <div class="attr variable">skipinitialspace<span
            class="annotation"></span><span class="default_value">
        
        = <span class="NoneType">
        None</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="Dialect.lineterminator" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Dialect.lineterminator&#39;)!
                                
                                    <div class="attr variable">lineterminator<span
            class="annotation"></span><span class="default_value">
        
        = <span class="NoneType">
        None</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="Dialect.quoting" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Dialect.quoting&#39;)!
                                
                                    <div class="attr variable">quoting<span
            class="annotation"></span><span class="default_value">
        
        = <span class="NoneType">
        None</span>
    
    </span></div>
                                
                                
                            </div>
                        
                    
                </section>
            
                <section id="__doc__">
                    
                        <div class="attr variable">__doc__<span
            class="annotation"></span><span class="default_value">
        
        = <span class="str">
        &#39;CSV parsing and writing.\n\nThis module provides classes that assist in the reading and writing\nof Comma Separated Value (CSV) files, and implements the interface\ndescribed by PEP 305.  Although many CSV files are simple to parse,\nthe format is not formally defined by a stable specification and\nis subtle enough that parsing lines of a CSV file with something\nlike line.split(&#34;,&#34;) is bound to fail.  The module supports three\nbasic APIs: reading, writing, and registration of dialects.\n\n\nDIALECT REGISTRATION:\n\nReaders and writers support a dialect argument, which is a convenient\nhandle on a group of settings.  When the dialect argument is a string,\nit identifies one of the dialects previously registered with the module.\nIf it is a class or instance, the attributes of the argument are used as\nthe settings for the reader or writer:\n\n    class excel:\n        delimiter = \&#39;,\&#39;\n        quotechar = \&#39;&#34;\&#39;\n        escapechar = None\n        doublequote = True\n        skipinitialspace = False\n        lineterminator = \&#39;\\r\\n\&#39;\n        quoting = QUOTE_MINIMAL\n\nSETTINGS:\n\n    * quotechar - specifies a one-character string to use as the\n        quoting character.  It defaults to \&#39;&#34;\&#39;.\n    * delimiter - specifies a one-character string to use as the\n        field separator.  It defaults to \&#39;,\&#39;.\n    * skipinitialspace - specifies how to interpret whitespace which\n        immediately follows a delimiter.  It defaults to False, which\n        means that whitespace immediately following a delimiter is part\n        of the following field.\n    * lineterminator -  specifies the character sequence which should\n        terminate rows.\n    * quoting - controls when quotes should be generated by the writer.\n        It can take on any of the following module constants:\n\n        csv.QUOTE_MINIMAL means only when required, for example, when a\n            field contains either the quotechar or the delimiter\n        csv.QUOTE_ALL means that quotes are always placed around fields.\n        csv.QUOTE_NONNUMERIC means that quotes are always placed around\n            fields which do not parse as integers or floating point\n            numbers.\n        csv.QUOTE_NONE means that quotes are never placed around fields.\n    * escapechar - specifies a one-character string used to escape\n        the delimiter when quoting is set to QUOTE_NONE.\n    * doublequote - controls the handling of quotes inside fields.  When\n        True, two consecutive quotes are interpreted as one during read,\n        and when writing, each quote character embedded in the data is\n        written as two quotes\n&#39;</span>
    
    </span></div>
                    
                    <div class="docstring"><p></p>
</div>
                    
                    
                </section>
            
                <section id="excel">
                    
                        <div class="attr class">class excel(<a href="#Dialect">csv.Dialect</a>):</div>
                    
                    <div class="docstring"><p>Describe the usual properties of Excel-generated CSV files.</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">excel</span><span class="p">(</span><span class="n">Dialect</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Describe the usual properties of Excel-generated CSV files.&quot;&quot;&quot;</span>
    <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span>
    <span class="n">quotechar</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span>
    <span class="n">doublequote</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">lineterminator</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
    <span class="n">quoting</span> <span class="o">=</span> <span class="n">QUOTE_MINIMAL</span>
</pre></div>

    </details>
                    
                    
                        
                            <div id="excel.delimiter" class="classattr">
                                declin!(&#39;csv&#39;, &#39;excel.delimiter&#39;)!
                                
                                    <div class="attr variable">delimiter<span
            class="annotation"></span><span class="default_value">
        
        = <span class="str">
        &#39;,&#39;</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="excel.quotechar" class="classattr">
                                declin!(&#39;csv&#39;, &#39;excel.quotechar&#39;)!
                                
                                    <div class="attr variable">quotechar<span
            class="annotation"></span><span class="default_value">
        
        = <span class="str">
        &#39;&#34;&#39;</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="excel.doublequote" class="classattr">
                                declin!(&#39;csv&#39;, &#39;excel.doublequote&#39;)!
                                
                                    <div class="attr variable">doublequote<span
            class="annotation"></span><span class="default_value">
        
        = <span class="bool">
        True</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="excel.skipinitialspace" class="classattr">
                                declin!(&#39;csv&#39;, &#39;excel.skipinitialspace&#39;)!
                                
                                    <div class="attr variable">skipinitialspace<span
            class="annotation"></span><span class="default_value">
        
        = <span class="bool">
        False</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="excel.lineterminator" class="classattr">
                                declin!(&#39;csv&#39;, &#39;excel.lineterminator&#39;)!
                                
                                    <div class="attr variable">lineterminator<span
            class="annotation"></span><span class="default_value">
        
        = <span class="str">
        &#39;\r\n&#39;</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="excel.quoting" class="classattr">
                                declin!(&#39;csv&#39;, &#39;excel.quoting&#39;)!
                                
                                    <div class="attr variable">quoting<span
            class="annotation"></span><span class="default_value">
        
        = <span class="int">
        0</span>
    
    </span></div>
                                
                                
                            </div>
                        
                    
                </section>
            
                <section id="excel_tab">
                    
                        <div class="attr class">class excel_tab(<a href="#excel">csv.excel</a>):</div>
                    
                    <div class="docstring"><p>Describe the usual properties of Excel-generated TAB-delimited files.</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">excel_tab</span><span class="p">(</span><span class="n">excel</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Describe the usual properties of Excel-generated TAB-delimited files.&quot;&quot;&quot;</span>
    <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span>
</pre></div>

    </details>
                    
                    
                        
                            <div id="excel_tab.delimiter" class="classattr">
                                declin!(&#39;csv&#39;, &#39;excel_tab.delimiter&#39;)!
                                
                                    <div class="attr variable">delimiter<span
            class="annotation"></span><span class="default_value">
        
        = <span class="str">
        &#39;\t&#39;</span>
    
    </span></div>
                                
                                
                            </div>
                        
                    
                </section>
            
                <section id="field_size_limit">
                    
                        
        <div class="attr function"><span class="def">def</span> <span
                class="name">field_size_limit</span><span class="signature">(unknown):</span></div>
    

                    
                    <div class="docstring"><p>Sets an upper limit on parsed fields.
    csv.field<em>size</em>limit([limit])</p>

<p>Returns old limit. If limit is not given, no new limit is set and
the old limit is returned</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span>
</pre></div>

    </details>
                    
                    
                </section>
            
                <section id="reader">
                    
                        
        <div class="attr function"><span class="def">def</span> <span
                class="name">reader</span><span class="signature">(unknown):</span></div>
    

                    
                    <div class="docstring"><p>csv<em>reader = reader(iterable [, dialect='excel']
                        [optional keyword args])
    for row in csv</em>reader:
        process(row)</p>

<p>The "iterable" argument can be any object that returns a line
of input for each iteration, such as a file object or a list.  The
optional "dialect" parameter is discussed below.  The function
also accepts optional keyword arguments which override settings
provided by the dialect.</p>

<p>The returned object is an iterator.  Each iteration returns a row
of the CSV file (which can span multiple input lines).</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span>
</pre></div>

    </details>
                    
                    
                </section>
            
                <section id="writer">
                    
                        
        <div class="attr function"><span class="def">def</span> <span
                class="name">writer</span><span class="signature">(unknown):</span></div>
    

                    
                    <div class="docstring"><p>csv<em>writer = csv.writer(fileobj [, dialect='excel']
                            [optional keyword args])
    for row in sequence:
        csv</em>writer.writerow(row)</p>

<pre><code>[or]

csv_writer = csv.writer(fileobj [, dialect='excel']
                        [optional keyword args])
csv_writer.writerows(rows)
</code></pre>

<p>The "fileobj" argument can be any object that supports the file API.</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span>
</pre></div>

    </details>
                    
                    
                </section>
            
                <section id="register_dialect">
                    
                        
        <div class="attr function"><span class="def">def</span> <span
                class="name">register_dialect</span><span class="signature">(unknown):</span></div>
    

                    
                    <div class="docstring"><p>Create a mapping from a string name to a dialect class.
dialect = csv.register_dialect(name[, dialect[, **fmtparams]])</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span>
</pre></div>

    </details>
                    
                    
                </section>
            
                <section id="get_dialect">
                    
                        
        <div class="attr function"><span class="def">def</span> <span
                class="name">get_dialect</span><span class="signature">(unknown):</span></div>
    

                    
                    <div class="docstring"><p>Return the dialect instance associated with name.
dialect = csv.get_dialect(name)</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span>
</pre></div>

    </details>
                    
                    
                </section>
            
                <section id="list_dialects">
                    
                        
        <div class="attr function"><span class="def">def</span> <span
                class="name">list_dialects</span><span class="signature">(unknown):</span></div>
    

                    
                    <div class="docstring"><p>Return a list of all know dialect names.
names = csv.list_dialects()</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span>
</pre></div>

    </details>
                    
                    
                </section>
            
                <section id="Sniffer">
                    
                        <div class="attr class">class Sniffer:</div>
                    
                    <div class="docstring"><p>"Sniffs" the format of a CSV file (i.e. delimiter, quotechar)
Returns a Dialect object.</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">Sniffer</span><span class="p">:</span>
    <span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    &quot;Sniffs&quot; the format of a CSV file (i.e. delimiter, quotechar)</span>
<span class="sd">    Returns a Dialect object.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># in case there is more than one possible delimiter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preferred</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\t</span><span class="s1">&#39;</span><span class="p">,</span> <span class="s1">&#39;;&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">,</span> <span class="s1">&#39;:&#39;</span><span class="p">]</span>


    <span class="k">def</span> <span class="nf">sniff</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">,</span> <span class="n">delimiters</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a dialect (or None) corresponding to the sample</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">quotechar</span><span class="p">,</span> <span class="n">doublequote</span><span class="p">,</span> <span class="n">delimiter</span><span class="p">,</span> <span class="n">skipinitialspace</span> <span class="o">=</span> \
                   <span class="bp">self</span><span class="o">.</span><span class="n">_guess_quote_and_delimiter</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span> <span class="n">delimiters</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">delimiter</span><span class="p">:</span>
            <span class="n">delimiter</span><span class="p">,</span> <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_guess_delimiter</span><span class="p">(</span><span class="n">sample</span><span class="p">,</span>
                                                                <span class="n">delimiters</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">delimiter</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">Error</span><span class="p">(</span><span class="s2">&quot;Could not determine delimiter&quot;</span><span class="p">)</span>

        <span class="k">class</span> <span class="nc">dialect</span><span class="p">(</span><span class="n">Dialect</span><span class="p">):</span>
            <span class="n">_name</span> <span class="o">=</span> <span class="s2">&quot;sniffed&quot;</span>
            <span class="n">lineterminator</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\r\n</span><span class="s1">&#39;</span>
            <span class="n">quoting</span> <span class="o">=</span> <span class="n">QUOTE_MINIMAL</span>
            <span class="c1"># escapechar = &#39;&#39;</span>

        <span class="n">dialect</span><span class="o">.</span><span class="n">doublequote</span> <span class="o">=</span> <span class="n">doublequote</span>
        <span class="n">dialect</span><span class="o">.</span><span class="n">delimiter</span> <span class="o">=</span> <span class="n">delimiter</span>
        <span class="c1"># _csv.reader won&#39;t accept a quotechar of &#39;&#39;</span>
        <span class="n">dialect</span><span class="o">.</span><span class="n">quotechar</span> <span class="o">=</span> <span class="n">quotechar</span> <span class="ow">or</span> <span class="s1">&#39;&quot;&#39;</span>
        <span class="n">dialect</span><span class="o">.</span><span class="n">skipinitialspace</span> <span class="o">=</span> <span class="n">skipinitialspace</span>

        <span class="k">return</span> <span class="n">dialect</span>


    <span class="k">def</span> <span class="nf">_guess_quote_and_delimiter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">delimiters</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Looks for text enclosed between two identical quotes</span>
<span class="sd">        (the probable quotechar) which are preceded and followed</span>
<span class="sd">        by the same character (the probable delimiter).</span>
<span class="sd">        For example:</span>
<span class="sd">                         ,&#39;some text&#39;,</span>
<span class="sd">        The quote with the most wins, same with the delimiter.</span>
<span class="sd">        If there is no quotechar the delimiter can&#39;t be determined</span>
<span class="sd">        this way.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">matches</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">restr</span> <span class="ow">in</span> <span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?P&lt;delim&gt;[^\w\n&quot;</span><span class="se">\&#39;</span><span class="s1">])(?P&lt;space&gt; ?)(?P&lt;quote&gt;[&quot;</span><span class="se">\&#39;</span><span class="s1">]).*?(?P=quote)(?P=delim)&#39;</span><span class="p">,</span> <span class="c1"># ,&quot;.*?&quot;,</span>
                      <span class="sa">r</span><span class="s1">&#39;(?:^|\n)(?P&lt;quote&gt;[&quot;</span><span class="se">\&#39;</span><span class="s1">]).*?(?P=quote)(?P&lt;delim&gt;[^\w\n&quot;</span><span class="se">\&#39;</span><span class="s1">])(?P&lt;space&gt; ?)&#39;</span><span class="p">,</span>   <span class="c1">#  &quot;.*?&quot;,</span>
                      <span class="sa">r</span><span class="s1">&#39;(?P&lt;delim&gt;[^\w\n&quot;</span><span class="se">\&#39;</span><span class="s1">])(?P&lt;space&gt; ?)(?P&lt;quote&gt;[&quot;</span><span class="se">\&#39;</span><span class="s1">]).*?(?P=quote)(?:$|\n)&#39;</span><span class="p">,</span>   <span class="c1"># ,&quot;.*?&quot;</span>
                      <span class="sa">r</span><span class="s1">&#39;(?:^|\n)(?P&lt;quote&gt;[&quot;</span><span class="se">\&#39;</span><span class="s1">]).*?(?P=quote)(?:$|\n)&#39;</span><span class="p">):</span>                            <span class="c1">#  &quot;.*?&quot; (no delim, no space)</span>
            <span class="n">regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">restr</span><span class="p">,</span> <span class="n">re</span><span class="o">.</span><span class="n">DOTALL</span> <span class="o">|</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="n">regexp</span><span class="o">.</span><span class="n">findall</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">matches</span><span class="p">:</span>
                <span class="k">break</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">matches</span><span class="p">:</span>
            <span class="c1"># (quotechar, doublequote, delimiter, skipinitialspace)</span>
            <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">quotes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">delims</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">spaces</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">groupindex</span> <span class="o">=</span> <span class="n">regexp</span><span class="o">.</span><span class="n">groupindex</span>
        <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="n">matches</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">=</span> <span class="n">groupindex</span><span class="p">[</span><span class="s1">&#39;quote&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="n">key</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">quotes</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">quotes</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">groupindex</span><span class="p">[</span><span class="s1">&#39;delim&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
                <span class="n">key</span> <span class="o">=</span> <span class="n">m</span><span class="p">[</span><span class="n">n</span><span class="p">]</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">key</span> <span class="ow">and</span> <span class="p">(</span><span class="n">delimiters</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">delimiters</span><span class="p">):</span>
                <span class="n">delims</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">delims</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">n</span> <span class="o">=</span> <span class="n">groupindex</span><span class="p">[</span><span class="s1">&#39;space&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="mi">1</span>
            <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">m</span><span class="p">[</span><span class="n">n</span><span class="p">]:</span>
                <span class="n">spaces</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">quotechar</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">quotes</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">quotes</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">delims</span><span class="p">:</span>
            <span class="n">delim</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">delims</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="n">delims</span><span class="o">.</span><span class="n">get</span><span class="p">)</span>
            <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="n">delims</span><span class="p">[</span><span class="n">delim</span><span class="p">]</span> <span class="o">==</span> <span class="n">spaces</span>
            <span class="k">if</span> <span class="n">delim</span> <span class="o">==</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">:</span> <span class="c1"># most likely a file with a single column</span>
                <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># there is *no* delimiter, it&#39;s a single column of quoted data</span>
            <span class="n">delim</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># if we see an extra quote between delimiters, we&#39;ve got a</span>
        <span class="c1"># double quoted format</span>
        <span class="n">dq_regexp</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span>
                               <span class="sa">r</span><span class="s2">&quot;((</span><span class="si">%(delim)s</span><span class="s2">)|^)\W*</span><span class="si">%(quote)s</span><span class="s2">[^</span><span class="si">%(delim)s</span><span class="s2">\n]*</span><span class="si">%(quote)s</span><span class="s2">[^</span><span class="si">%(delim)s</span><span class="s2">\n]*</span><span class="si">%(quote)s</span><span class="s2">\W*((</span><span class="si">%(delim)s</span><span class="s2">)|$)&quot;</span> <span class="o">%</span> \
                               <span class="p">{</span><span class="s1">&#39;delim&#39;</span><span class="p">:</span><span class="n">re</span><span class="o">.</span><span class="n">escape</span><span class="p">(</span><span class="n">delim</span><span class="p">),</span> <span class="s1">&#39;quote&#39;</span><span class="p">:</span><span class="n">quotechar</span><span class="p">},</span> <span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span>



        <span class="k">if</span> <span class="n">dq_regexp</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="n">doublequote</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">doublequote</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">return</span> <span class="p">(</span><span class="n">quotechar</span><span class="p">,</span> <span class="n">doublequote</span><span class="p">,</span> <span class="n">delim</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">_guess_delimiter</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">delimiters</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        The delimiter /should/ occur the same number of times on</span>
<span class="sd">        each row. However, due to malformed data, it may not. We don&#39;t want</span>
<span class="sd">        an all or nothing approach, so we allow for small variations in this</span>
<span class="sd">        number.</span>
<span class="sd">          1) build a table of the frequency of each character on every line.</span>
<span class="sd">          2) build a table of frequencies of this frequency (meta-frequency?),</span>
<span class="sd">             e.g.  &#39;x occurred 5 times in 10 rows, 6 times in 1000 rows,</span>
<span class="sd">             7 times in 2 rows&#39;</span>
<span class="sd">          3) use the mode of the meta-frequency to determine the /expected/</span>
<span class="sd">             frequency for that character</span>
<span class="sd">          4) find out how often the character actually meets that goal</span>
<span class="sd">          5) the character that best meets its goal is the delimiter</span>
<span class="sd">        For performance reasons, the data is evaluated in chunks, so it can</span>
<span class="sd">        try and evaluate the smallest portion of the data possible, evaluating</span>
<span class="sd">        additional chunks as necessary.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">filter</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)))</span>

        <span class="n">ascii</span> <span class="o">=</span> <span class="p">[</span><span class="nb">chr</span><span class="p">(</span><span class="n">c</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">127</span><span class="p">)]</span> <span class="c1"># 7-bit ASCII</span>

        <span class="c1"># build frequency tables</span>
        <span class="n">chunkLength</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
        <span class="n">iteration</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">charFrequency</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">modes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">delims</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">start</span><span class="p">,</span> <span class="n">end</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">chunkLength</span>
        <span class="k">while</span> <span class="n">start</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">):</span>
            <span class="n">iteration</span> <span class="o">+=</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">data</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">end</span><span class="p">]:</span>
                <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">ascii</span><span class="p">:</span>
                    <span class="n">metaFrequency</span> <span class="o">=</span> <span class="n">charFrequency</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">char</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="c1"># must count even if frequency is 0</span>
                    <span class="n">freq</span> <span class="o">=</span> <span class="n">line</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">char</span><span class="p">)</span>
                    <span class="c1"># value is the mode</span>
                    <span class="n">metaFrequency</span><span class="p">[</span><span class="n">freq</span><span class="p">]</span> <span class="o">=</span> <span class="n">metaFrequency</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
                    <span class="n">charFrequency</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="n">metaFrequency</span>

            <span class="k">for</span> <span class="n">char</span> <span class="ow">in</span> <span class="n">charFrequency</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                <span class="n">items</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">charFrequency</span><span class="p">[</span><span class="n">char</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="c1"># get the mode of the frequencies</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">modes</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">items</span><span class="p">,</span> <span class="n">key</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                    <span class="c1"># adjust the mode - subtract the sum of all</span>
                    <span class="c1"># other frequencies</span>
                    <span class="n">items</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">modes</span><span class="p">[</span><span class="n">char</span><span class="p">])</span>
                    <span class="n">modes</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">modes</span><span class="p">[</span><span class="n">char</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">modes</span><span class="p">[</span><span class="n">char</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                                   <span class="o">-</span> <span class="nb">sum</span><span class="p">(</span><span class="n">item</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">))</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">modes</span><span class="p">[</span><span class="n">char</span><span class="p">]</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

            <span class="c1"># build a list of possible delimiters</span>
            <span class="n">modeList</span> <span class="o">=</span> <span class="n">modes</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="n">total</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">chunkLength</span> <span class="o">*</span> <span class="n">iteration</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="p">)))</span>
            <span class="c1"># (rows of consistent data) / (number of rows) = 100%</span>
            <span class="n">consistency</span> <span class="o">=</span> <span class="mf">1.0</span>
            <span class="c1"># minimum consistency threshold</span>
            <span class="n">threshold</span> <span class="o">=</span> <span class="mf">0.9</span>
            <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">delims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">consistency</span> <span class="o">&gt;=</span> <span class="n">threshold</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">modeList</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">if</span> <span class="p">((</span><span class="n">v</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">/</span><span class="n">total</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">consistency</span> <span class="ow">and</span>
                            <span class="p">(</span><span class="n">delimiters</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">delimiters</span><span class="p">)):</span>
                            <span class="n">delims</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">v</span>
                <span class="n">consistency</span> <span class="o">-=</span> <span class="mf">0.01</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">delims</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">delim</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">delims</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span><span class="mi">0</span><span class="p">]</span>
                <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">delim</span><span class="p">)</span> <span class="o">==</span>
                                    <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%c</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">delim</span><span class="p">))</span>
                <span class="k">return</span> <span class="p">(</span><span class="n">delim</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="p">)</span>

            <span class="c1"># analyze another chunkLength lines</span>
            <span class="n">start</span> <span class="o">=</span> <span class="n">end</span>
            <span class="n">end</span> <span class="o">+=</span> <span class="n">chunkLength</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">delims</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="c1"># if there&#39;s more than one, fall back to a &#39;preferred&#39; list</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">delims</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">preferred</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">d</span> <span class="ow">in</span> <span class="n">delims</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
                    <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">d</span><span class="p">)</span> <span class="o">==</span>
                                        <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%c</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">d</span><span class="p">))</span>
                    <span class="k">return</span> <span class="p">(</span><span class="n">d</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="p">)</span>

        <span class="c1"># nothing else indicates a preference, pick the character that</span>
        <span class="c1"># dominates(?)</span>
        <span class="n">items</span> <span class="o">=</span> <span class="p">[(</span><span class="n">v</span><span class="p">,</span><span class="n">k</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">delims</span><span class="o">.</span><span class="n">items</span><span class="p">()]</span>
        <span class="n">items</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
        <span class="n">delim</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>

        <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="n">delim</span><span class="p">)</span> <span class="o">==</span>
                            <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%c</span><span class="s2"> &quot;</span> <span class="o">%</span> <span class="n">delim</span><span class="p">))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">delim</span><span class="p">,</span> <span class="n">skipinitialspace</span><span class="p">)</span>


    <span class="k">def</span> <span class="nf">has_header</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sample</span><span class="p">):</span>
        <span class="c1"># Creates a dictionary of types of data in each column. If any</span>
        <span class="c1"># column is of a single type (say, integers), *except* for the first</span>
        <span class="c1"># row, then the first row is presumed to be labels. If the type</span>
        <span class="c1"># can&#39;t be determined, it is assumed to be a string in which case</span>
        <span class="c1"># the length of the string is the determining factor: if all of the</span>
        <span class="c1"># rows except for the first are the same length, it&#39;s a header.</span>
        <span class="c1"># Finally, a &#39;vote&#39; is taken at the end for each column, adding or</span>
        <span class="c1"># subtracting from the likelihood of the first row being a header.</span>

        <span class="n">rdr</span> <span class="o">=</span> <span class="n">reader</span><span class="p">(</span><span class="n">StringIO</span><span class="p">(</span><span class="n">sample</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">sniff</span><span class="p">(</span><span class="n">sample</span><span class="p">))</span>

        <span class="n">header</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">rdr</span><span class="p">)</span> <span class="c1"># assume first row is header</span>

        <span class="n">columns</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>
        <span class="n">columnTypes</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span> <span class="n">columnTypes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="n">checked</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">rdr</span><span class="p">:</span>
            <span class="c1"># arbitrary number of rows to check, to keep it sane</span>
            <span class="k">if</span> <span class="n">checked</span> <span class="o">&gt;</span> <span class="mi">20</span><span class="p">:</span>
                <span class="k">break</span>
            <span class="n">checked</span> <span class="o">+=</span> <span class="mi">1</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span> <span class="o">!=</span> <span class="n">columns</span><span class="p">:</span>
                <span class="k">continue</span> <span class="c1"># skip rows that have irregular number of columns</span>

            <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">columnTypes</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>

                <span class="k">for</span> <span class="n">thisType</span> <span class="ow">in</span> <span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">float</span><span class="p">,</span> <span class="nb">complex</span><span class="p">]:</span>
                    <span class="k">try</span><span class="p">:</span>
                        <span class="n">thisType</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
                        <span class="k">break</span>
                    <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">OverflowError</span><span class="p">):</span>
                        <span class="k">pass</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="c1"># fallback to length of string</span>
                    <span class="n">thisType</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>

                <span class="k">if</span> <span class="n">thisType</span> <span class="o">!=</span> <span class="n">columnTypes</span><span class="p">[</span><span class="n">col</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">columnTypes</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="c1"># add new column type</span>
                        <span class="n">columnTypes</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">thisType</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="c1"># type is inconsistent, remove column from</span>
                        <span class="c1"># consideration</span>
                        <span class="k">del</span> <span class="n">columnTypes</span><span class="p">[</span><span class="n">col</span><span class="p">]</span>

        <span class="c1"># finally, compare results against first row and &quot;vote&quot;</span>
        <span class="c1"># on whether it&#39;s a header</span>
        <span class="n">hasHeader</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">col</span><span class="p">,</span> <span class="n">colType</span> <span class="ow">in</span> <span class="n">columnTypes</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">colType</span><span class="p">)</span> <span class="o">==</span> <span class="nb">type</span><span class="p">(</span><span class="mi">0</span><span class="p">):</span> <span class="c1"># it&#39;s a length</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="n">col</span><span class="p">])</span> <span class="o">!=</span> <span class="n">colType</span><span class="p">:</span>
                    <span class="n">hasHeader</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hasHeader</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="k">else</span><span class="p">:</span> <span class="c1"># attempt typecast</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">colType</span><span class="p">(</span><span class="n">header</span><span class="p">[</span><span class="n">col</span><span class="p">])</span>
                <span class="k">except</span> <span class="p">(</span><span class="ne">ValueError</span><span class="p">,</span> <span class="ne">TypeError</span><span class="p">):</span>
                    <span class="n">hasHeader</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">hasHeader</span> <span class="o">-=</span> <span class="mi">1</span>

        <span class="k">return</span> <span class="n">hasHeader</span> <span class="o">&gt;</span> <span class="mi">0</span>
</pre></div>

    </details>
                    
                    
                        
                            <div id="Sniffer.__init__" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Sniffer.__init__&#39;)!
                                
                                    
        <div class="attr function">Sniffer(self)</div>
    

                                
                                
                            </div>
                        
                            <div id="Sniffer.sniff" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Sniffer.sniff&#39;)!
                                
                                    
        <div class="attr function"><span class="def">def</span> <span
                class="name">sniff</span><span class="signature">(self, sample, delimiters=None):</span></div>
    

                                
                                Returns a dialect (or None) corresponding to the sample
                            </div>
                        
                            <div id="Sniffer.has_header" class="classattr">
                                declin!(&#39;csv&#39;, &#39;Sniffer.has_header&#39;)!
                                
                                    
        <div class="attr function"><span class="def">def</span> <span
                class="name">has_header</span><span class="signature">(self, sample):</span></div>
    

                                
                                
                            </div>
                        
                    
                </section>
            
                <section id="unregister_dialect">
                    
                        
        <div class="attr function"><span class="def">def</span> <span
                class="name">unregister_dialect</span><span class="signature">(unknown):</span></div>
    

                    
                    <div class="docstring"><p>Delete the name/dialect mapping associated with a string name.
csv.unregister_dialect(name)</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span>
</pre></div>

    </details>
                    
                    
                </section>
            
                <section id="__version__">
                    
                        <div class="attr variable">__version__<span
            class="annotation"></span><span class="default_value">
        
        = <span class="str">
        &#39;1.0&#39;</span>
    
    </span></div>
                    
                    <div class="docstring"><p></p>
</div>
                    
                    
                </section>
            
                <section id="DictReader">
                    
                        <div class="attr class">class DictReader:</div>
                    
                    <div class="docstring"><p></p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">DictReader</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">fieldnames</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restkey</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">restval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">dialect</span><span class="o">=</span><span class="s2">&quot;excel&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fieldnames</span> <span class="o">=</span> <span class="n">fieldnames</span>   <span class="c1"># list of keys for the dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restkey</span> <span class="o">=</span> <span class="n">restkey</span>          <span class="c1"># key to catch long rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restval</span> <span class="o">=</span> <span class="n">restval</span>          <span class="c1"># default value for short rows</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="n">reader</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dialect</span> <span class="o">=</span> <span class="n">dialect</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_num</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="fm">__iter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">fieldnames</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fieldnames</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">_fieldnames</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">StopIteration</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">line_num</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_fieldnames</span>

    <span class="nd">@fieldnames</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">fieldnames</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_fieldnames</span> <span class="o">=</span> <span class="n">value</span>

    <span class="k">def</span> <span class="fm">__next__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">line_num</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># Used only for its side effect.</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span>
        <span class="n">row</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">line_num</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">line_num</span>

        <span class="c1"># unlike the basic reader, we prefer not to return blanks,</span>
        <span class="c1"># because we will typically wind up with a dict full of None</span>
        <span class="c1"># values</span>
        <span class="k">while</span> <span class="n">row</span> <span class="o">==</span> <span class="p">[]:</span>
            <span class="n">row</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">)</span>
        <span class="n">d</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">,</span> <span class="n">row</span><span class="p">))</span>
        <span class="n">lf</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">)</span>
        <span class="n">lr</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">row</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">lf</span> <span class="o">&lt;</span> <span class="n">lr</span><span class="p">:</span>
            <span class="n">d</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">restkey</span><span class="p">]</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="n">lf</span><span class="p">:]</span>
        <span class="k">elif</span> <span class="n">lf</span> <span class="o">&gt;</span> <span class="n">lr</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">[</span><span class="n">lr</span><span class="p">:]:</span>
                <span class="n">d</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">restval</span>
        <span class="k">return</span> <span class="n">d</span>
</pre></div>

    </details>
                    
                    
                        
                            <div id="DictReader.__init__" class="classattr">
                                declin!(&#39;csv&#39;, &#39;DictReader.__init__&#39;)!
                                
                                    
        <div class="attr function">DictReader(self, f, fieldnames=None, restkey=None, restval=None, dialect=&#39;excel&#39;, *args, **kwds)</div>
    

                                
                                
                            </div>
                        
                            <div id="DictReader.fieldnames" class="classattr">
                                declin!(&#39;csv&#39;, &#39;DictReader.fieldnames&#39;)!
                                
                                    <div class="attr variable">fieldnames<span
            class="annotation"></span><span class="default_value">
        
    </span></div>
                                
                                None
                            </div>
                        
                    
                </section>
            
                <section id="DictWriter">
                    
                        <div class="attr class">class DictWriter:</div>
                    
                    <div class="docstring"><p></p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">DictWriter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">fieldnames</span><span class="p">,</span> <span class="n">restval</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="n">extrasaction</span><span class="o">=</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span>
                 <span class="n">dialect</span><span class="o">=</span><span class="s2">&quot;excel&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span> <span class="o">=</span> <span class="n">fieldnames</span>    <span class="c1"># list of keys for the dict</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">restval</span> <span class="o">=</span> <span class="n">restval</span>          <span class="c1"># for writing short dicts</span>
        <span class="k">if</span> <span class="n">extrasaction</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;raise&quot;</span><span class="p">,</span> <span class="s2">&quot;ignore&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;extrasaction (</span><span class="si">%s</span><span class="s2">) must be &#39;raise&#39; or &#39;ignore&#39;&quot;</span>
                             <span class="o">%</span> <span class="n">extrasaction</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">extrasaction</span> <span class="o">=</span> <span class="n">extrasaction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">writer</span> <span class="o">=</span> <span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="n">dialect</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwds</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">writeheader</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">header</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">header</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_dict_to_list</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rowdict</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">extrasaction</span> <span class="o">==</span> <span class="s2">&quot;raise&quot;</span><span class="p">:</span>
            <span class="n">wrong_fields</span> <span class="o">=</span> <span class="n">rowdict</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span>
            <span class="k">if</span> <span class="n">wrong_fields</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;dict contains fields not in fieldnames: &quot;</span>
                                 <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="nb">repr</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">wrong_fields</span><span class="p">]))</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">rowdict</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">restval</span><span class="p">)</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">fieldnames</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">writerow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rowdict</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dict_to_list</span><span class="p">(</span><span class="n">rowdict</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">writerows</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rowdicts</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dict_to_list</span><span class="p">,</span> <span class="n">rowdicts</span><span class="p">))</span>
</pre></div>

    </details>
                    
                    
                        
                            <div id="DictWriter.__init__" class="classattr">
                                declin!(&#39;csv&#39;, &#39;DictWriter.__init__&#39;)!
                                
                                    
        <div class="attr function">DictWriter(self, f, fieldnames, restval=&#39;&#39;, extrasaction=&#39;raise&#39;, dialect=&#39;excel&#39;, *args, **kwds)</div>
    

                                
                                
                            </div>
                        
                            <div id="DictWriter.writeheader" class="classattr">
                                declin!(&#39;csv&#39;, &#39;DictWriter.writeheader&#39;)!
                                
                                    
        <div class="attr function"><span class="def">def</span> <span
                class="name">writeheader</span><span class="signature">(self):</span></div>
    

                                
                                
                            </div>
                        
                            <div id="DictWriter.writerow" class="classattr">
                                declin!(&#39;csv&#39;, &#39;DictWriter.writerow&#39;)!
                                
                                    
        <div class="attr function"><span class="def">def</span> <span
                class="name">writerow</span><span class="signature">(self, rowdict):</span></div>
    

                                
                                
                            </div>
                        
                            <div id="DictWriter.writerows" class="classattr">
                                declin!(&#39;csv&#39;, &#39;DictWriter.writerows&#39;)!
                                
                                    
        <div class="attr function"><span class="def">def</span> <span
                class="name">writerows</span><span class="signature">(self, rowdicts):</span></div>
    

                                
                                
                            </div>
                        
                    
                </section>
            
                <section id="unix_dialect">
                    
                        <div class="attr class">class unix_dialect(<a href="#Dialect">csv.Dialect</a>):</div>
                    
                    <div class="docstring"><p>Describe the usual properties of Unix-generated CSV files.</p>
</div>
                    
                        <details>
        <summary>View Source</summary>
        <div class="codehilite"><pre><span></span><span class="k">class</span> <span class="nc">unix_dialect</span><span class="p">(</span><span class="n">Dialect</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Describe the usual properties of Unix-generated CSV files.&quot;&quot;&quot;</span>
    <span class="n">delimiter</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span>
    <span class="n">quotechar</span> <span class="o">=</span> <span class="s1">&#39;&quot;&#39;</span>
    <span class="n">doublequote</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="n">skipinitialspace</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="n">lineterminator</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span>
    <span class="n">quoting</span> <span class="o">=</span> <span class="n">QUOTE_ALL</span>
</pre></div>

    </details>
                    
                    
                        
                            <div id="unix_dialect.delimiter" class="classattr">
                                declin!(&#39;csv&#39;, &#39;unix_dialect.delimiter&#39;)!
                                
                                    <div class="attr variable">delimiter<span
            class="annotation"></span><span class="default_value">
        
        = <span class="str">
        &#39;,&#39;</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="unix_dialect.quotechar" class="classattr">
                                declin!(&#39;csv&#39;, &#39;unix_dialect.quotechar&#39;)!
                                
                                    <div class="attr variable">quotechar<span
            class="annotation"></span><span class="default_value">
        
        = <span class="str">
        &#39;&#34;&#39;</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="unix_dialect.doublequote" class="classattr">
                                declin!(&#39;csv&#39;, &#39;unix_dialect.doublequote&#39;)!
                                
                                    <div class="attr variable">doublequote<span
            class="annotation"></span><span class="default_value">
        
        = <span class="bool">
        True</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="unix_dialect.skipinitialspace" class="classattr">
                                declin!(&#39;csv&#39;, &#39;unix_dialect.skipinitialspace&#39;)!
                                
                                    <div class="attr variable">skipinitialspace<span
            class="annotation"></span><span class="default_value">
        
        = <span class="bool">
        False</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="unix_dialect.lineterminator" class="classattr">
                                declin!(&#39;csv&#39;, &#39;unix_dialect.lineterminator&#39;)!
                                
                                    <div class="attr variable">lineterminator<span
            class="annotation"></span><span class="default_value">
        
        = <span class="str">
        &#39;\n&#39;</span>
    
    </span></div>
                                
                                
                            </div>
                        
                            <div id="unix_dialect.quoting" class="classattr">
                                declin!(&#39;csv&#39;, &#39;unix_dialect.quoting&#39;)!
                                
                                    <div class="attr variable">quoting<span
            class="annotation"></span><span class="default_value">
        
        = <span class="int">
        1</span>
    
    </span></div>
                                
                                
                            </div>
                        
                    
                </section>
            
        </main>
    </div>

<footer><a title="built with pdoc 1.0"
           href="https://github.com/mitmproxy/pdoc"><svg xmlns="http://www.w3.org/2000/svg" viewBox="-1 0 60 30"><path d="M29.621 21.293c-.011-.273-.214-.475-.511-.481a.5.5 0 0 0-.489.503l-.044 1.393c-.097.551-.695 1.215-1.566 1.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43 3.43 0 0 0-.365-.306.49.49 0 0 0-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707 1.187-3.413 2.131-4.328 1.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351 1.378-1.008 2.271-2.586 2.271-4.362 0-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516 0-1.477-1.202-2.679-2.679-2.679-.791 0-1.496.352-1.987.9a6.3 6.3 0 0 0-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477 0-2.679 1.202-2.679 2.679A2.65 2.65 0 0 0 .97 6.554c-.383.747-.595 1.572-.595 2.41 0 2.311 1.507 4.29 3.635 5.107-.037.699-.147 2.27-.423 3.294l-.137.461c-.622 2.042-2.515 8.257 1.727 10.643 1.614.908 3.06 1.248 4.317 1.248 2.665 0 4.492-1.524 5.322-2.401 1.476-1.559 2.886-1.854 6.491.82 1.877 1.393 3.514 1.753 4.861 1.068 2.223-1.713 2.811-3.867 3.399-6.374.077-.846.056-1.469.054-1.537zm-4.835 4.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693 1.198 1.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145 1.189.368 1.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056 1.211-.031zm-4.535 1.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66 11.66 0 0 0 .972-.573zm.983-.664c.359-.237.738-.418 1.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381 1.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133 0-.306-.26-.45-.621.417.091.854.07 1.291-.031zm-2.066-8.077a4.78 4.78 0 0 1-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331 2.302a10.32 10.32 0 0 1-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45 2.157l-.701-.403c.214-.115.536-.249.891-.376a11.57 11.57 0 0 1-.19.779zm-.181 1.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87 4.141c0 .152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15 1.15 0 0 0-.314.783 1.16 1.16 0 0 0 1.162 1.162c.457 0 .842-.27 1.032-.653.026.117.042.238.042.362a1.68 1.68 0 0 1-1.679 1.679 1.68 1.68 0 0 1-1.679-1.679c0-.843.626-1.535 1.436-1.654zM5.059 5.406A1.68 1.68 0 0 1 3.38 7.085a1.68 1.68 0 0 1-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16 1.16 0 0 0 1.162-1.162 1.14 1.14 0 0 0-.474-.912c.015 0 .03-.005.045-.005.926.001 1.679.754 1.679 1.68zM3.198 4.141c0 .152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375 8.964c0-.52.103-1.035.288-1.52.466.394 1.06.64 1.717.64 1.144 0 2.116-.725 2.499-1.738.383 1.012 1.355 1.738 2.499 1.738.867 0 1.631-.421 2.121-1.062.307.605.478 1.267.478 1.942 0 2.486-2.153 4.51-4.801 4.51s-4.801-2.023-4.801-4.51zm24.342 19.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315 1.391-4.163 3.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11 6.11 0 0 0 1.18.115 6.01 6.01 0 0 0 2.536-.562l-.006.175c-.802.215-1.848.612-2.021 1.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311 1.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381 1.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999 1.429-.018.278.095.532.316.713.675.556 1.231.721 1.653.721.059 0 .104-.014.158-.02.207.707.641 1.64 1.513 1.64h.013c.8-.008 1.236-.345 1.462-.626.173-.216.268-.457.325-.692.424.195.93.374 1.372.374.151 0 .294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15 0 .294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356 0 .595-.101.767-.229.438.435 1.094.992 1.656 1.067.106.014.205.021.296.021a1.56 1.56 0 0 0 .323-.035c.17.575.453 1.289.866 1.605.358.273.665.362.914.362a.99.99 0 0 0 .421-.093 1.03 1.03 0 0 0 .245-.164c.168.428.39.846.68 1.068.358.273.665.362.913.362a.99.99 0 0 0 .421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127 0 .25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443 1.486-1.107 2.761-2.086 3.257zM8.66 9.925a.5.5 0 1 0-1 0c0 .653-.818 1.205-1.787 1.205s-1.787-.552-1.787-1.205a.5.5 0 1 0-1 0c0 1.216 1.25 2.205 2.787 2.205s2.787-.989 2.787-2.205zm4.4 15.965l-.208.097c-2.661 1.258-4.708 1.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4 0 0 0-.385-.414c-.242-.029-.406.164-.414.385-.046 1.249.367 3.686 2.202 4.896.708.467 1.547.7 2.51.7 1.248 0 2.706-.392 4.362-1.174l.185-.086a.4.4 0 0 0 .205-.527c-.089-.204-.326-.291-.527-.206zM9.547 2.292c.093.077.205.114.317.114a.5.5 0 0 0 .318-.886L8.817.397a.5.5 0 0 0-.703.068.5.5 0 0 0 .069.703l1.364 1.124zm-7.661-.065c.086 0 .173-.022.253-.068l1.523-.893a.5.5 0 0 0-.506-.863l-1.523.892a.5.5 0 0 0-.179.685c.094.158.261.247.432.247z" transform="matrix(-1 0 0 1 58 0)" fill="#3bb300"/><path d="M.3 21.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54 1.34-.54 1.06 0 1.42.28.38.26.44.78.76-1.04 2.38-1.04 1.64 0 3.1 1.54 1.46 1.54 1.46 3.58 0 2.04-1.46 3.58-1.44 1.54-3.08 1.54-1.64 0-2.38-.92v4.04q0 .46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62 0-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46 1.18 0 .64.46 1.18.48.52 1.2.52.74 0 1.24-.52.52-.52.52-1.18 0-.66-.48-1.18-.48-.54-1.26-.54-.76 0-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12 1-.12.64 0 1.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0 .46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38 0-1.54-.98-.84.96-2.34.96-1.8 0-3.28-1.56-1.48-1.58-1.48-3.66 0-2.1 1.48-3.68 1.5-1.58 3.28-1.58 1.48 0 2.3 1v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24 10.86q.52.54 1.26.54.74 0 1.22-.54.5-.54.5-1.18 0-.66-.48-1.22-.46-.56-1.26-.56-.8 0-1.28.56-.48.54-.48 1.2 0 .66.52 1.2zm7.833-1.2q0-2.4 1.68-3.96 1.68-1.56 3.84-1.56 2.16 0 3.82 1.56 1.66 1.54 1.66 3.94 0 1.66-.86 2.96-.86 1.28-2.1 1.9-1.22.6-2.54.6-1.32 0-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18 1.44q.64.48 1.3.48.66 0 1.32-.5.66-.5.66-1.48 0-.98-.62-1.46-.62-.48-1.34-.48-.72 0-1.34.5-.62.5-.62 1.48 0 .96.64 1.46zm11.412-1.44q0 .84.56 1.32.56.46 1.18.46.64 0 1.18-.36.56-.38.9-.38.6 0 1.46 1.06.46.58.46 1.04 0 .76-1.1 1.42-1.14.8-2.8.8-1.86 0-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36 0-1.3.52-2.34.52-1.06 1.34-1.7 1.66-1.32 3.54-1.32.76 0 1.48.22.72.2 1.06.4l.32.2q.36.24.56.38.52.4.52.92 0 .5-.42 1.14-.72 1.1-1.38 1.1-.38 0-1.08-.44-.36-.34-1.04-.34-.66 0-1.24.48-.58.48-.58 1.34z" fill="green"/></svg></a></footer>
</body>
</html>